<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Driver Learner Test Coach</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #f2f2f2;
    }
    #quiz-container {
      background: #fff;
      border-radius: 10px;
      padding: 20px;
      max-width: 600px;
      margin: auto;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }
    #question-text {
      font-size: 18px;
      margin-bottom: 20px;
    }
    .option {
      background: #e0e0e0;
      padding: 10px;
      border-radius: 5px;
      margin-bottom: 10px;
      cursor: pointer;
    }
    .option:hover {
      background: #d5d5d5;
    }
    .selected {
      background: #90caf9;
    }
    #next-btn {
      margin-top: 20px;
      padding: 10px 15px;
      font-size: 16px;
    }
    #score-container {
      position: fixed;
      top: 20px;
      right: 20px;
      font-size: 18px;
      background-color: rgba(0, 0, 0, 0.5);
      color: white;
      padding: 10px;
      border-radius: 5px;
    }
    #message-container {
      font-size: 16px;
      padding: 10px;
      margin-top: 20px;
      text-align: center;
      border-radius: 5px;
    }
    .correct {
      background-color: #4caf50;
      color: white;
      
    }
    .wrong {
      background-color: #f44336;
      color: white;
    }
    .emtpyBadge {
      background-color: ##fdfbfb08;
      color: white;
    }
    #nextDiv{
      background: ##fdfbfb08
      border-radius: 10px;
      padding: 20px;
      max-width: 600px;
      margin: auto;
     
    }

  </style>
</head>
<body>
  <div id="score-container">Score: 0</div>
  <div id="quiz-container">
    <h2 id="question-text">Loading question...</h2>
    <img id="question-image" src="" alt="" style="display: none; max-width: 100%; margin-top: 15px;" />
    <div id="options-container"></div>   
  </div>

  <div id="nextDiv"> 
    <button id="next-btn">Next</button>
    <div id="message-container"></div>
  </div>
  

  <script>
    let currentQuestion = 0;
    let score = 0;
    let selectedOption = null;
    let wrongQuestions = [];
    let questionsToUse = []; // Dynamic questions list
  
    const allQuestions = [  // <-- renamed from `questions` to `allQuestions`
      {
        "question": "Unless otherwise posted, what is the basic speed limit outside a city, town or village on a primary highway?",
        "options": ["100 km/h", "90 km/h", "110 km/h", "80 km/h"],
        "answer": "100 km/h"
      },
      {
        "question": "When backing a passenger vehicle to the left, a driver should:",
        "options": [
          "Look in the inside rear-view mirror and make steering adjustments as necessary",
          "Look over the right shoulder with occasional glances to the front",
          "Look over the left shoulder with occasional glances to the front",
          "Without shoulder checking, use the inside and outside rear-view mirrors to ensure the best view"
        ],
        "answer": "Look over the left shoulder with occasional glances to the front"
      },
      {
        "question": "When approaching an intersection and facing a traffic control light that is showing a green right-turn arrow and a red light, a driver:",
        "options": [
          "Must stop and wait for a green light before turning in the direction of the arrow",
          "May go straight through the intersection without stopping",
          "May proceed when safe, without stopping, in the direction of the arrow",
          "May turn left without stopping"
        ],
        "answer": "May proceed when safe, without stopping, in the direction of the arrow"
      },
      {
        "question": "Alberta has a demerit point system where a fully licenced (non-learner, non-probationary) driver is suspended when they accumulate:",
        "options": ["15 points", "8 points", "5 points", "12 points"],
        "answer": "15 points"
      },
      {
        "question": "When passing a large truck on a two-way highway, a driver should:",
        "options": [
          "Leave extra room before returning to their lane",
          "Return to their lane when signalled by the truck’s headlights",
          "Return to their lane when the truck is no longer visible in any of their rear-view mirrors",
          "Return to their lane once they have cleared the truck’s front bumper"
        ],
        "answer": "Leave extra room before returning to their lane"
      },
      {
        "question": "This sign indicates:",
        "options": [
          "Route for vehicles over 4500 kg.",
          "Route for slow moving vehicles",
          "Reserved lane for buses",
          "Dangerous goods route"
        ],
        "answer": "Dangerous goods route",
        image: "images/Dangerous-goods.png"
      }
    ];
  
    function loadScore() {
      // console.log(`Score: ${score}/${questionsToUse.length}`);
      const scoreContainer = document.getElementById('score-container');
      scoreContainer.textContent = `Score: ${score}/${questionsToUse.length}`;
    }
  
    function showQuestion() {
      const q = questionsToUse[currentQuestion];
      console.log(q.question);
      document.getElementById('question-text').textContent = q.question;
  
      const imageElement = document.getElementById('question-image');
      if (q.image) {
        imageElement.src = q.image;
        imageElement.style.display = 'block';
      } else {
        imageElement.style.display = 'none';
      }
  
      const optionsContainer = document.getElementById('options-container');
      optionsContainer.innerHTML = '';
      selectedOption = null;
      document.getElementById('message-container').textContent = '';
      document.getElementById('message-container').className = 'emtpyBadge';
  
      q.options.forEach(option => {
        const div = document.createElement('div');
        div.textContent = option;
        div.classList.add('option');
        div.addEventListener('click', () => {
          if (selectedOption) return;
  
          document.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected'));
          div.classList.add('selected');
          selectedOption = option;
  
          const correctAnswer = q.answer;
          const messageContainer = document.getElementById('message-container');
  
          if (selectedOption === correctAnswer) {
            messageContainer.textContent = 'Correct answer!';
            messageContainer.className = 'correct';
            score++;
          } else {
            messageContainer.textContent = `Wrong answer! The correct answer was: ${correctAnswer}`;
            messageContainer.className = 'wrong';
            wrongQuestions.push(q);
  
            document.querySelectorAll('.option').forEach(option => {
              if (option.textContent === correctAnswer) {
                option.style.backgroundColor = "green";
              }
            });
          }
  
          loadScore();
        });
  
        optionsContainer.appendChild(div);
      });
    }
  
    document.getElementById('next-btn').addEventListener('click', () => {
      if (!selectedOption) {
        alert('Please select an answer.');
        return;
      }
  
      currentQuestion++;
  
      if (currentQuestion < questionsToUse.length) {
        showQuestion();
      } else {
        showCompleteQuiz();
      }
    });
  
    function restartQuiz() {
      currentQuestion = 0;
      score = 0;
      wrongQuestions = [];
      questionsToUse = [...allQuestions]; // Reset full question set
      LoadQuestionCard();
      loadScore();
      showQuestion();
    }


    function showCompleteQuiz()
    {
      document.getElementById('message-container').textContent = '';
      document.getElementById('message-container').className = 'emtpyBadge';
      document.getElementById('next-btn').style.display = 'none';


      const container = document.getElementById('quiz-container');
        container.innerHTML = `
          <h2>Quiz Complete!</h2>
          <p>Your final score is: ${score}/${questionsToUse.length}</p>
          <button id="restart-btn">Restart</button>
          ${wrongQuestions.length > 0 ? `<button id="retake-wrong-btn" style="margin-left:80px;">Retake Wrong Items</button>` : ""}
        `;
  
        document.getElementById('restart-btn').addEventListener('click', restartQuiz);
  
        if (wrongQuestions.length > 0) {
          document.getElementById('retake-wrong-btn').addEventListener('click', retakeWrongQuestions);
        }
    } 

    function LoadQuestionCard()
    {
      document.getElementById('next-btn').style.display = 'inline-block';


       const container = document.getElementById('quiz-container');
       container.innerHTML = `
             <h2 id="question-text">Loading question...</h2>
            <img id="question-image" src="" alt="" style="display: none; max-width: 100%; margin-top: 15px;" />
            <div id="options-container"></div>           
           
        `;       
    }
  
    function retakeWrongQuestions() {
      document.getElementById('next-btn').style.display = 'inline-block';

      if (wrongQuestions.length === 0) return;
  
      questionsToUse = [...wrongQuestions];

       
      
      wrongQuestions = [];
      currentQuestion = 0;
      score = 0;
      LoadQuestionCard();
      loadScore();
      showQuestion();
    }
  
    // Initialize the quiz
    questionsToUse = [...allQuestions];
    loadScore();
    showQuestion();
  </script>
  
</body>
</html>
